<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute partial identification bounds on local ecological quantities — ei_bounds • seine</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute partial identification bounds on local ecological quantities — ei_bounds"><meta name="description" content="For each observation, computes the minimum and maximum value of each local
estimand that is consistent with the accounting identity and the bounds
on the outcome. Optionally aggregate the computed bounds across units."><meta property="og:description" content="For each observation, computes the minimum and maximum value of each local
estimand that is consistent with the accounting identity and the bounds
on the outcome. Optionally aggregate the computed bounds across units."><meta property="og:image" content="https://corymccartan.com/seine/logo.svg"><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2KH5JZ6JS1"></script><script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-2KH5JZ6JS1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">seine</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/seine.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CoryMcCartan/seine/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Compute partial identification bounds on local ecological quantities</h1>
      <small class="dont-index">Source: <a href="https://github.com/CoryMcCartan/seine/blob/main/R/ei_bounds.R" class="external-link"><code>R/ei_bounds.R</code></a></small>
      <div class="d-none name"><code>ei_bounds.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For each observation, computes the minimum and maximum value of each local
estimand that is consistent with the accounting identity and the bounds
on the outcome. Optionally aggregate the computed bounds across units.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ei_bounds</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">total</span>,</span>
<span>  contrast <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  sum_one <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  global <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'ei_spec'</span></span>
<span><span class="fu">ei_bounds</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">total</span>,</span>
<span>  contrast <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  sum_one <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  global <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">ei_bounds</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">total</span>,</span>
<span>  contrast <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  sum_one <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  global <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu">ei_bounds</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">total</span>,</span>
<span>  contrast <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  sum_one <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  global <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'matrix'</span></span>
<span><span class="fu">ei_bounds</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">total</span>,</span>
<span>  contrast <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  sum_one <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  global <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">ei_bounds</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'ei_bounds'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">as.array</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code>ei_bounds</code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments (ignored)</p></dd>


<dt id="arg-total">total<a class="anchor" aria-label="anchor" href="#arg-total"></a></dt>
<dd><p>&lt;<code><a href="https://rlang.r-lib.org/reference/args_data_masking.html" class="external-link">data-masking</a></code>&gt; A variable
containing the total number of observations in each aggregate unit. For
example, the column containing the total number of voters. Required for
computing weights unless <code>x</code> is an <code><a href="ei_spec.html">ei_spec()</a></code> object.</p></dd>


<dt id="arg-contrast">contrast<a class="anchor" aria-label="anchor" href="#arg-contrast"></a></dt>
<dd><p>If provided, a list containing entries <code>predictor</code> and
<code>outcome</code>, each containing a contrast vector.  If only one of <code>predictor</code>
or <code>outcome</code> is provided, the contrast will be calculated for all levels of
the other variable.  For example <code>list(predictor = c(1, -1, 0))</code> will
calculate the difference in each outcome between the first and second
predictor groups; <code>list(outcome = c(1, -1))</code> will calculate the difference
between the two outcomes for each predictor group; and
<code>list(predictor = c(1, -1, 0), outcome = c(1, -1))</code> will calculate the
difference in differences.</p></dd>


<dt id="arg-bounds">bounds<a class="anchor" aria-label="anchor" href="#arg-bounds"></a></dt>
<dd><p>A vector <code>c(min, max)</code> of bounds for the outcome.
If <code>bounds = NULL</code>, they will be inferred from the outcome variable:
if it is contained within \([0, 1]\), for instance, then the bounds will
be <code>c(0, 1)</code>. The default <code>bounds = FALSE</code> uses an unbounded outcome.</p></dd>


<dt id="arg-sum-one">sum_one<a class="anchor" aria-label="anchor" href="#arg-sum-one"></a></dt>
<dd><p>If <code>TRUE</code>, the outcome variables are constrained to sum to one
within each predictor group. Can only apply when <code>bounds</code> are enforced and
there is more than one outcome variable. If <code>NULL</code>, infers <code>sum_one = TRUE</code>
when the bounds are <code>c(0, 1)</code> and the outcome variables sum to 1.</p></dd>


<dt id="arg-global">global<a class="anchor" aria-label="anchor" href="#arg-global"></a></dt>
<dd><p>If <code>TRUE</code>, aggregate the bounds across units to produce bounds
on the global estimands.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A formula such as <code>y ~ x0 + x1</code> specifying the outcome <code>y</code>
and the predictors of interest <code>x</code>. The predictors should form a partition,
that is, <code>x0 + x1 = 1</code> for each observation.
Users can be include more than two predictors as well, e.g.
<code>pct_white + pct_black + pct_hisp + pct_other</code>.
If there are just two predictors, it is acceptable to only include one in
the formula; the other will be formed as 1 minus the provided predictor.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>When a <strong>formula</strong> is used, <code>data</code> is a <strong>data frame</strong> containing
both the predictors and the outcome.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>When <code>x</code> is a <strong>data frame</strong> or <strong>matrix</strong>, <code>y</code> is the outcome
specified as:</p><ul><li><p>A <strong>data frame</strong> with numeric columns.</p></li>
<li><p>A <strong>matrix</strong></p></li>
<li><p>A numeric <strong>vector</strong>.</p></li>
</ul><p>When the outcome is a proportion, you can use <code><a href="ei_proportions.html">ei_proportions()</a></code> to assist
in preparing it.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with bounds. The <code>.row</code> column in the output
corresponds to the observation index in the input. The <code>min</code> and <code>max</code>
columns contain the minimum and maximum values for each local estimand.
The <code>weight</code> column contains the product of the predictor variable and total
for each observation, where applicable. Taking a weighted average of the
bounds against this column will produce global bounds. It has class <code>ei_bounds</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="methods-by-generic-">Methods (by generic)<a class="anchor" aria-label="anchor" href="#methods-by-generic-"></a></h2>

<ul><li><p><code>as.array(ei_bounds)</code>: Format bounds as an array with dimensions
<code>&lt;rows&gt;*&lt;predictors&gt;*&lt;outcomes&gt;*2</code>. Does not work if the object has been sorted.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">elec_1968</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spec</span> <span class="op">=</span> <span class="fu"><a href="ei_spec.html">ei_spec</a></span><span class="op">(</span><span class="va">elec_1968</span>, <span class="va">vap_white</span><span class="op">:</span><span class="va">vap_other</span>, <span class="va">pres_dem_hum</span><span class="op">:</span><span class="va">pres_abs</span>,</span></span>
<span class="r-in"><span>               total <span class="op">=</span> <span class="va">pres_total</span>, covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">state</span>, <span class="va">pop_urban</span>, <span class="va">farm</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ei_bounds</span><span class="op">(</span><span class="va">spec</span>, bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 13,716 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     .row predictor outcome      weight     min    max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     1 vap_white pres_dem_hum  <span style="text-decoration: underline;">5</span>877. 0       0.262 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     2 vap_white pres_dem_hum <span style="text-decoration: underline;">16</span>131. 0       0.122 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     3 vap_white pres_dem_hum  <span style="text-decoration: underline;">4</span>872. 0       0.397 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     4 vap_white pres_dem_hum  <span style="text-decoration: underline;">3</span>566. 0       0.180 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     5 vap_white pres_dem_hum  <span style="text-decoration: underline;">8</span>801. 0.019<span style="text-decoration: underline;">0</span>  0.038<span style="text-decoration: underline;">2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     6 vap_white pres_dem_hum  <span style="text-decoration: underline;">1</span>698. 0       1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     7 vap_white pres_dem_hum  <span style="text-decoration: underline;">4</span>970. 0       0.250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     8 vap_white pres_dem_hum <span style="text-decoration: underline;">22</span>844. 0.007<span style="text-decoration: underline;">07</span> 0.183 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     9 vap_white pres_dem_hum  <span style="text-decoration: underline;">7</span>731. 0       0.178 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>    10 vap_white pres_dem_hum  <span style="text-decoration: underline;">5</span>259. 0.009<span style="text-decoration: underline;">15</span> 0.085<span style="text-decoration: underline;">5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 13,706 more rows</span></span>
<span class="r-in"><span><span class="fu">ei_bounds</span><span class="op">(</span><span class="va">spec</span>, bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 12 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    predictor outcome            min     max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> vap_white pres_dem_hum 0.176     0.375  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> vap_black pres_dem_hum 0.004<span style="text-decoration: underline;">67</span>   0.927  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> vap_other pres_dem_hum 0         1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> vap_white pres_rep_nix 0.247     0.421  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> vap_black pres_rep_nix 0         0.808  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> vap_other pres_rep_nix 0         0.991  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> vap_white pres_ind_wal 0.213     0.415  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> vap_black pres_ind_wal 0.008<span style="text-decoration: underline;">74</span>   0.946  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> vap_other pres_ind_wal 0         1.000  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> vap_white pres_abs     0.000<span style="text-decoration: underline;">010</span>8 0.001<span style="text-decoration: underline;">79</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> vap_black pres_abs     0         0.008<span style="text-decoration: underline;">44</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> vap_other pres_abs     0         0.091<span style="text-decoration: underline;">0</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Infer bounds</span></span></span>
<span class="r-in"><span><span class="fu">ei_bounds</span><span class="op">(</span><span class="va">pres_ind_wal</span> <span class="op">~</span> <span class="va">vap_white</span>, data <span class="op">=</span> <span class="va">elec_1968</span>, total <span class="op">=</span> <span class="va">pres_total</span>, bounds <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,286 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     .row predictor outcome      weight   min   max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     1 vap_white pres_ind_wal  <span style="text-decoration: underline;">5</span>877. 0.620 0.934</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     2 vap_white pres_ind_wal <span style="text-decoration: underline;">16</span>131. 0.726 0.889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     3 vap_white pres_ind_wal  <span style="text-decoration: underline;">4</span>872. 0.487 1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     4 vap_white pres_ind_wal  <span style="text-decoration: underline;">3</span>566. 0.743 1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     5 vap_white pres_ind_wal  <span style="text-decoration: underline;">8</span>801. 0.721 0.741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     6 vap_white pres_ind_wal  <span style="text-decoration: underline;">1</span>698. 0     1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     7 vap_white pres_ind_wal  <span style="text-decoration: underline;">4</span>970. 0.644 1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     8 vap_white pres_ind_wal <span style="text-decoration: underline;">22</span>844. 0.668 0.844</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     9 vap_white pres_ind_wal  <span style="text-decoration: underline;">7</span>731. 0.640 1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>    10 vap_white pres_ind_wal  <span style="text-decoration: underline;">5</span>259. 0.828 0.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2,276 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With contrast</span></span></span>
<span class="r-in"><span><span class="fu">ei_bounds</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">spec</span>,</span></span>
<span class="r-in"><span>    bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>predictor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,143 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     .row predictor             outcome                        min   max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     1 vap_white - vap_black pres_dem_hum - pres_rep_nix -<span style="color: #BB0000;">0.942</span> 0.588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     2 vap_white - vap_black pres_dem_hum - pres_rep_nix -<span style="color: #BB0000;">0.895</span> 0.958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     3 vap_white - vap_black pres_dem_hum - pres_rep_nix -<span style="color: #BB0000;">0.704</span> 0.523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     4 vap_white - vap_black pres_dem_hum - pres_rep_nix -<span style="color: #BB0000;">0.727</span> 0.445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     5 vap_white - vap_black pres_dem_hum - pres_rep_nix -<span style="color: #BB0000;">1.21</span>  0.831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     6 vap_white - vap_black pres_dem_hum - pres_rep_nix -<span style="color: #BB0000;">0.854</span> 0.973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     7 vap_white - vap_black pres_dem_hum - pres_rep_nix -<span style="color: #BB0000;">0.633</span> 0.466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     8 vap_white - vap_black pres_dem_hum - pres_rep_nix -<span style="color: #BB0000;">1.13</span>  0.953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     9 vap_white - vap_black pres_dem_hum - pres_rep_nix -<span style="color: #BB0000;">0.614</span> 0.551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>    10 vap_white - vap_black pres_dem_hum - pres_rep_nix -<span style="color: #BB0000;">1.06</span>  0.950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1,133 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># manually aggregate min/max</span></span></span>
<span class="r-in"><span><span class="co"># easier with dplyr:</span></span></span>
<span class="r-in"><span><span class="co"># summarize(across(min:max, ~ weighted.mean(.x, weight)), .by=c(predictor, outcome))</span></span></span>
<span class="r-in"><span><span class="va">grp_units</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fu">ei_bounds</span><span class="op">(</span><span class="va">spec</span>, bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="op">~</span> <span class="va">predictor</span> <span class="op">+</span> <span class="va">outcome</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">grp_units</span>, <span class="kw">function</span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        predictor <span class="op">=</span> <span class="va">b</span><span class="op">$</span><span class="va">predictor</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        outcome <span class="op">=</span> <span class="va">b</span><span class="op">$</span><span class="va">outcome</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html" class="external-link">weighted.mean</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">min</span>, <span class="va">b</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html" class="external-link">weighted.mean</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">max</span>, <span class="va">b</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 12 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    predictor outcome            min     max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> vap_black pres_abs     0         0.008<span style="text-decoration: underline;">44</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> vap_other pres_abs     0         0.091<span style="text-decoration: underline;">0</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> vap_white pres_abs     0.000<span style="text-decoration: underline;">010</span>8 0.001<span style="text-decoration: underline;">79</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> vap_black pres_dem_hum 0.004<span style="text-decoration: underline;">67</span>   0.927  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> vap_other pres_dem_hum 0         1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> vap_white pres_dem_hum 0.176     0.375  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> vap_black pres_ind_wal 0.008<span style="text-decoration: underline;">74</span>   0.946  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> vap_other pres_ind_wal 0         1.000  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> vap_white pres_ind_wal 0.213     0.415  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> vap_black pres_rep_nix 0         0.808  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> vap_other pres_rep_nix 0         0.991  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> vap_white pres_rep_nix 0.247     0.421  </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cory McCartan, Shiro Kuriwaki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

