[{"path":"https://corymccartan.com/seine/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Cory McCartan Shiro Kuriwaki Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://corymccartan.com/seine/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Cory McCartan. Author, maintainer. Shiro Kuriwaki. Author.","code":""},{"path":"https://corymccartan.com/seine/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"McCartan C, Kuriwaki S (2025). seine: Semiparametric Ecological Inference. R package version 0.0.0.9000, https://github.com/CoryMcCartan/seine.","code":"@Manual{,   title = {seine: Semiparametric Ecological Inference},   author = {Cory McCartan and Shiro Kuriwaki},   year = {2025},   note = {R package version 0.0.0.9000},   url = {https://github.com/CoryMcCartan/seine}, }"},{"path":[]},{"path":"https://corymccartan.com/seine/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Semiparametric Ecological Inference","text":"can install development version seine ","code":"remotes::install_github(\"CoryMcCartan/seine\")"},{"path":[]},{"path":"https://corymccartan.com/seine/reference/ei-impl.html","id":null,"dir":"Reference","previous_headings":"","what":"Low-level implementations of ei_ridge() and ei_riesz() — ei_ridge_impl","title":"Low-level implementations of ei_ridge() and ei_riesz() — ei_ridge_impl","text":"checks performed inputs. Use ei_ridge() ei_riesz() strongly recommended unless many regressions must fit, e.g., within tight loop. works single outcome, .e., y must vector, matrix.","code":""},{"path":"https://corymccartan.com/seine/reference/ei-impl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Low-level implementations of ei_ridge() and ei_riesz() — ei_ridge_impl","text":"","code":"ei_ridge_impl(x, y, z, weights, penalty = NULL)  ei_riesz_impl(x, z, total, weights, penalty)"},{"path":"https://corymccartan.com/seine/reference/ei-impl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Low-level implementations of ei_ridge() and ei_riesz() — ei_ridge_impl","text":"x matrix predictors y vector outcomes z matrix covariates weights vector estimation weights penalty ridge penalty (non-negative scalar), must specified. Recommended value penalty used ei_ridge(), stored penalty entry fitted model object. total vector total observations per unit.","code":""},{"path":"https://corymccartan.com/seine/reference/ei-impl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Low-level implementations of ei_ridge() and ei_riesz() — ei_ridge_impl","text":"list model components.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_est.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate ecological quantities — ei_est","title":"Estimate ecological quantities — ei_est","text":"Produces estimates overall conditional means fitted ecological inference model Riesz representer. regression model Riesz representer provided, debiased machine learning (DML) estimate produced.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_est.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate ecological quantities — ei_est","text":"","code":"ei_est(   regr = NULL,   riesz = NULL,   data,   total,   outcome = NULL,   conf_level = FALSE )  # S3 method for class 'ei_est' as.matrix(x, se = FALSE, ...)  # S3 method for class 'ei_est' vcov(object, ...)"},{"path":"https://corymccartan.com/seine/reference/ei_est.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate ecological quantities — ei_est","text":"regr fitted regression model, ei_ridge(), another kind regression model wrapped ei_wrap_model(). riesz provided regr ei_riesz() object, riesz set value regr regr set NULL. users can call function ei_est(<riesz>, data = <data>). riesz fitted Riesz representer, ei_riesz(), matrix Riesz weights data data frame, matrix, ei_spec object used fit regression Riesz representer. total <tidy-select> variable containing total number observations aggregate unit. example, column containing total number voters. Required data ei_spec() object riesz provided. outcome <data-masking> vector matrix outcome variables. required riesz provided alone (without regr) data ei_spec object. conf_level numeric specifying level confidence intervals. FALSE (default), confidence intervals calculated. Standard errors always returned. x, object object class ei_est se TRUE, return standard errors instead estimates. ... Additional arguments (ignored)","code":""},{"path":"https://corymccartan.com/seine/reference/ei_est.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate ecological quantities — ei_est","text":"data frame estimates. two additional attributes: vcov, containing estimated covariance matrix estimates, n, containing number aggregate units used estimation (number rows data).","code":""},{"path":"https://corymccartan.com/seine/reference/ei_est.html","id":"methods-by-generic-","dir":"Reference","previous_headings":"","what":"Methods (by generic)","title":"Estimate ecological quantities — ei_est","text":".matrix(ei_est): Format estimates standard errors matrix vcov(ei_est): Extract full covariance matrix estimates","code":""},{"path":"https://corymccartan.com/seine/reference/ei_est.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate ecological quantities — ei_est","text":"","code":"data(elec_1968)  spec = ei_spec(elec_1968, vap_white:vap_other, pres_dem_hum:pres_oth,                total = pres_total, covariates = c(pop_urban, farm))  m = ei_ridge(spec) rr = ei_riesz(spec, penalty = m$penalty)  ei_est(regr = m, data = spec, conf_level = 0.95) # Plug-in estimate #> # A tibble: 15 × 6 #>    predictor outcome estimate std.error conf.low conf.high #>    <chr>     <chr>      <dbl>     <dbl>    <dbl>     <dbl> #>  1 white     dem_hum  0.248    0.0154    0.218     0.278   #>  2 black     dem_hum  0.420    0.0381    0.345     0.495   #>  3 other     dem_hum  3.87     0.477     2.93      4.80    #>  4 white     rep_nix  0.387    0.0271    0.334     0.440   #>  5 black     rep_nix -0.0894   0.00506  -0.0993   -0.0795  #>  6 other     rep_nix  1.40     0.233     0.943     1.85    #>  7 white     ind_wal  0.363    0.0279    0.309     0.418   #>  8 black     ind_wal  0.667    0.0418    0.585     0.749   #>  9 other     ind_wal -4.25     0.595    -5.41     -3.08    #> 10 white     abs      0.00153  0.000179  0.00118   0.00188 #> 11 black     abs      0.00278  0.000290  0.00221   0.00334 #> 12 other     abs     -0.0188   0.00233  -0.0233   -0.0142  #> 13 white     oth      0.00153  0.000179  0.00118   0.00188 #> 14 black     oth      0.00278  0.000290  0.00221   0.00334 #> 15 other     oth     -0.0188   0.00233  -0.0233   -0.0142  ei_est(riesz = rr, data = spec) # Weighted (Riesz) estimate #> # A tibble: 15 × 4 #>    predictor outcome estimate std.error #>    <chr>     <chr>      <dbl>     <dbl> #>  1 white     dem_hum  0.248    0.0213   #>  2 black     dem_hum  0.420    0.0796   #>  3 other     dem_hum  3.87     2.36     #>  4 white     rep_nix  0.387    0.0211   #>  5 black     rep_nix -0.0894   0.0587   #>  6 other     rep_nix  1.40     1.72     #>  7 white     ind_wal  0.363    0.0214   #>  8 black     ind_wal  0.667    0.0830   #>  9 other     ind_wal -4.25     1.78     #> 10 white     abs      0.00153  0.000282 #> 11 black     abs      0.00278  0.000858 #> 12 other     abs     -0.0188   0.0173   #> 13 white     oth      0.00153  0.000282 #> 14 black     oth      0.00278  0.000858 #> 15 other     oth     -0.0188   0.0173   est = ei_est(regr = m, riesz = rr, data = spec) # Double/debiased ML estimate as.matrix(est) #>         dem_hum     rep_nix    ind_wal          abs          oth #> white 0.2481598  0.38699489  0.3633165  0.001528811  0.001528811 #> black 0.4200405 -0.08937756  0.6665617  0.002775393  0.002775393 #> other 3.8671722  1.39827216 -4.2466833 -0.018760984 -0.018760984 as.matrix(est, se=TRUE) #>          dem_hum    rep_nix    ind_wal          abs          oth #> white 0.01770099 0.02909194 0.02826466 0.0002937972 0.0002937972 #> black 0.04602302 0.02328971 0.05257540 0.0008645117 0.0008645117 #> other 0.78202192 0.53981237 1.09745695 0.0158211423 0.0158211423 vcov(est)[1:4, 1:4] #>               white:dem_hum black:dem_hum other:dem_hum white:rep_nix #> white:dem_hum  0.0003133249  0.0002732986   0.006420237  0.0004300809 #> black:dem_hum  0.0002732986  0.0021181180   0.011485449  0.0007930489 #> other:dem_hum  0.0064202365  0.0114854489   0.611558291  0.0129493462 #> white:rep_nix  0.0004300809  0.0007930489   0.012949346  0.0008463410"},{"path":"https://corymccartan.com/seine/reference/ei_proportions.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert counts to proportions — ei_proportions","title":"Convert counts to proportions — ei_proportions","text":"Divides counts specified columns specified total sum, possibly storing result new column. Also checks --bounds missing values, can create column containing remainder amount proportions sum 1.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_proportions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert counts to proportions — ei_proportions","text":"","code":"ei_proportions(data, ..., .total = \".total\", .other = \".other\", clamp = 0.001)"},{"path":"https://corymccartan.com/seine/reference/ei_proportions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert counts to proportions — ei_proportions","text":"data data frame. ... <tidy-select> Columns convert proportions. one column completely missing, imputed 1 minus total. .total <tidy-select> Column use total. column exist, created sum selected columns. Supports renaming syntax. .<tidy-select> Column store remainder, selected columns plus .sum 1. selected columns sum 1 normalization, argument used; otherwise created overwritten. calculation .performed clamping (see ). clamp Proportions clamp 0 1 rounded 0 1, respectively.  Values outside clamp throw error. Set clamp=0 disable clamp=Inf allow --bounds proportions (recommended).","code":""},{"path":"https://corymccartan.com/seine/reference/ei_proportions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert counts to proportions — ei_proportions","text":"modified data frame.  Unselected columns unmodified.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_proportions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert counts to proportions — ei_proportions","text":"","code":"data(elec_1968) # Make a data frame with counts d_unnorm = with(head(elec_1968, 10), data.frame(   vap = vap,   vap_white = vap * vap_white,   vap_black = vap * vap_black,   vap_other = vap * vap_other ))  ei_proportions(d_unnorm, vap_white:vap_black, .total=vap) # `.other` column created #>      vap vap_white  vap_black vap_other       .other #> 1  12744 0.7611425 0.23713120        22 0.0017263026 #> 2  33012 0.8595662 0.13737429       101 0.0030594935 #> 3  12370 0.6104285 0.38876314        10 0.0008084074 #> 4   7575 0.7832343 0.21570957         8 0.0010561056 #> 5  15856 0.9811428 0.01810040        12 0.0007568113 #> 6   6019 0.3912610 0.60873899         0 0.0000000000 #> 7  12341 0.6791184 0.32015234         9 0.0007292764 #> 8  55547 0.8501269 0.14738870       138 0.0024843826 #> 9  21117 0.7267604 0.27252924        15 0.0007103282 #> 10  9215 0.9290288 0.07010309         8 0.0008681498 ei_proportions(d_unnorm, vap_white:vap_other) # no total provided #>      vap vap_white  vap_black    vap_other .total #> 1  12744 0.7611425 0.23713120 0.0017263026  12744 #> 2  33012 0.8595662 0.13737429 0.0030594935  33012 #> 3  12370 0.6104285 0.38876314 0.0008084074  12370 #> 4   7575 0.7832343 0.21570957 0.0010561056   7575 #> 5  15856 0.9811428 0.01810040 0.0007568113  15856 #> 6   6019 0.3912610 0.60873899 0.0000000000   6019 #> 7  12341 0.6791184 0.32015234 0.0007292764  12341 #> 8  55547 0.8501269 0.14738870 0.0024843826  55547 #> 9  21117 0.7267604 0.27252924 0.0007103282  21117 #> 10  9215 0.9290288 0.07010309 0.0008681498   9215 # renaming allowed ei_proportions(d_unnorm, white=vap_white, black=vap_black,                .total=c(total=vap), .other=\"vap_other\") #>    total     white      black    vap_other #> 1  12744 0.7611425 0.23713120 0.0017263026 #> 2  33012 0.8595662 0.13737429 0.0030594935 #> 3  12370 0.6104285 0.38876314 0.0008084074 #> 4   7575 0.7832343 0.21570957 0.0010561056 #> 5  15856 0.9811428 0.01810040 0.0007568113 #> 6   6019 0.3912610 0.60873899 0.0000000000 #> 7  12341 0.6791184 0.32015234 0.0007292764 #> 8  55547 0.8501269 0.14738870 0.0024843826 #> 9  21117 0.7267604 0.27252924 0.0007103282 #> 10  9215 0.9290288 0.07010309 0.0008681498"},{"path":"https://corymccartan.com/seine/reference/ei_ridge.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit an ecological inference regression model — ei_ridge","title":"Fit an ecological inference regression model — ei_ridge","text":"Fits penalized regression model ecological inference, allowing overall unit-level estimates conditional means using ei_est().","code":""},{"path":"https://corymccartan.com/seine/reference/ei_ridge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit an ecological inference regression model — ei_ridge","text":"","code":"ei_ridge(x, ...)  # S3 method for class 'formula' ei_ridge(formula, data, weights, penalty = NULL, ...)  # S3 method for class 'ei_spec' ei_ridge(x, weights, penalty = NULL, ...)  # S3 method for class 'data.frame' ei_ridge(x, y, z, weights, penalty = NULL, ...)  # S3 method for class 'matrix' ei_ridge(x, y, z, weights, penalty = NULL, ...)  # Default S3 method ei_ridge(x, ...)"},{"path":"https://corymccartan.com/seine/reference/ei_ridge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit an ecological inference regression model — ei_ridge","text":"x Depending context: data frame predictors. matrix predictors. ei_spec object containing outcome, predictor, covariates. Predictors must proportions sum 1 across rows. can use ei_proportions() assist preparing predictor variables. ... currently used, required extensibility. formula formula y ~ x0 + x1 | z specifying outcome y regressed covariates interest x.  x's form partition, , x0 + x1 = 1 observation. Users can include two variables well, e.g. pct_white + pct_black + pct_hisp + pct_other. Include additional covariates separated vertical bar |. covariates necessary ei_riesz ei_ridge. See ei_wrap_model formulas require covariates. data formula used, data data frame containing predictors outcome. weights <data-masking> vector unit weights estimation. may different total number observations aggregate unit (see total argument ei_spec()). See discussion 'Weights' choosing parameter. default, uniform weights, makes slightly stronger--necessary assumption relationship unit totals unknown data. penalty ridge penalty (non-negative scalar). Set NULL automatically determine penalty minimizes mean-square error, via efficient leave-one-cross validation procedure. ridge regression solution $$\\hat\\beta = (X^\\top X + \\lambda )^{-1}X^\\top y,$$ \\(\\lambda\\) value penalty. Keep mind choosing penalty manually covariates z scaled mean zero unit variance fitting. y x data frame matrix, y outcome specified : data frame numeric columns. matrix numeric vector. outcome proportion, can use ei_proportions() assist preparing . z x data frame matrix, w covariates, specified : data frame numeric columns. matrix scaled internally mean zero unit variance.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_ridge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit an ecological inference regression model — ei_ridge","text":"ei_ridge object, supports various ridge-methods.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_ridge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit an ecological inference regression model — ei_ridge","text":"regression calculated using singular value decomposition, allows efficient recalculation different penalty values part leave-one-cross-validation.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_ridge.html","id":"weights","dir":"Reference","previous_headings":"","what":"Weights","title":"Fit an ecological inference regression model — ei_ridge","text":"weakest identification result ecological inference makes assumption number observations per aggregate unit (totals). requires, however, weighting estimation steps according totals. may reduce efficiency totals variable slightly stronger condition holds. Specifically, totals conditionally mean-independent missing data (aggregation-unit level means outcome within predictor level), given covariates, appropriate use uniform weights estimation, fixed set weights. general, estimation efficiency improved units larger variance outcome receive less weight. Various bulit-options provided helper functions ei_wgt().","code":""},{"path":"https://corymccartan.com/seine/reference/ei_ridge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit an ecological inference regression model — ei_ridge","text":"","code":"data(elec_1968)  spec = ei_spec(elec_1968, vap_white:vap_other, pres_dem_hum:pres_oth,                total = pres_total, covariates = c(pop_urban, farm)) ei_ridge(spec) #> An ecological inference model with 5 outcomes, 3 groups, and 1143 observations #> Fit with penalty = 1.01453e-08  ei_ridge(pres_dem_hum + pres_rep_nix + pres_ind_wal + pres_abs + pres_oth ~       vap_white + vap_black + vap_other | pop_urban + farm, data = elec_1968) #> An ecological inference model with 5 outcomes, 3 groups, and 1143 observations #> Fit with penalty = 1.01453e-08"},{"path":"https://corymccartan.com/seine/reference/ei_riesz.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Riesz representer for ecological inference — ei_riesz","title":"Estimate Riesz representer for ecological inference — ei_riesz","text":"Fits penalized Riesz regression ecological inference, allowing overall estimates conditional means using ei_est().","code":""},{"path":"https://corymccartan.com/seine/reference/ei_riesz.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Riesz representer for ecological inference — ei_riesz","text":"","code":"ei_riesz(x, ...)  # S3 method for class 'formula' ei_riesz(formula, data, total, weights, penalty, ...)  # S3 method for class 'ei_spec' ei_riesz(x, weights, penalty, ...)  # S3 method for class 'data.frame' ei_riesz(x, z, total, weights, penalty, ...)  # S3 method for class 'matrix' ei_riesz(x, z, total, weights, penalty, ...)  # Default S3 method ei_riesz(x, ...)"},{"path":"https://corymccartan.com/seine/reference/ei_riesz.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Riesz representer for ecological inference — ei_riesz","text":"x Depending context: data frame predictors. matrix predictors. ei_spec object containing outcome, predictor, covariates. Predictors must proportions sum 1 across rows. can use ei_proportions() assist preparing predictor variables. ... currently used, required extensibility. formula formula y ~ x0 + x1 | z specifying outcome y regressed covariates interest x.  x's form partition, , x0 + x1 = 1 observation. Users can include two variables well, e.g. pct_white + pct_black + pct_hisp + pct_other. Include additional covariates separated vertical bar |. covariates necessary ei_riesz ei_ridge. See ei_wrap_model formulas require covariates. data formula used, data data frame containing predictors outcome. total <tidy-select> variable containing total number observations aggregate unit. example, column containing total number voters. Required default. weights <data-masking> vector unit weights estimation. may different total number observations aggregate unit (see total argument ei_spec()). See discussion 'Weights' choosing parameter. default, uniform weights, makes slightly stronger--necessary assumption relationship unit totals unknown data. penalty ridge penalty (non-negative scalar), must specified. Recommended value penalty used ei_ridge(), stored penalty entry fitted model object. z x data frame matrix, w covariates, specified : data frame numeric columns. matrix scaled internally mean zero unit variance.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_riesz.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Riesz representer for ecological inference — ei_riesz","text":"ei_riesz object.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_riesz.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Riesz representer for ecological inference — ei_riesz","text":"regression calculated using singular value decomposition.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_riesz.html","id":"weights","dir":"Reference","previous_headings":"","what":"Weights","title":"Estimate Riesz representer for ecological inference — ei_riesz","text":"weakest identification result ecological inference makes assumption number observations per aggregate unit (totals). requires, however, weighting estimation steps according totals. may reduce efficiency totals variable slightly stronger condition holds. Specifically, totals conditionally mean-independent missing data (aggregation-unit level means outcome within predictor level), given covariates, appropriate use uniform weights estimation, fixed set weights. general, estimation efficiency improved units larger variance outcome receive less weight. Various bulit-options provided helper functions ei_wgt().","code":""},{"path":"https://corymccartan.com/seine/reference/ei_riesz.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Riesz representer for ecological inference — ei_riesz","text":"","code":"data(elec_1968)  # Recommended: get ridge penalty from ei_ridge() spec = ei_spec(elec_1968, vap_white:vap_other, pres_dem_hum:pres_oth,                total = pres_total, covariates = c(pop_urban, farm)) m = ei_ridge(spec)  ei_riesz(spec, penalty = m$penalty) #> A Riesz representer with 3 groups and 1143 observations #> Fit with penalty = 1.01453e-08  rr = ei_riesz(~ vap_white + vap_black + vap_other | pop_urban + farm,               data = elec_1968, total = pres_total, penalty = m$penalty) summary(rr) #> Second moment of representer: #>    vap_white    vap_black    vap_other  #>     4.461456    48.486776 31468.779992  #>  #> Second moment of representer (leave-one-out): #>    vap_white    vap_black    vap_other  #>     4.992583    51.531747 46719.396300   # Examine the weights and check they have mean 1 head(weights(rr, group = \"vap_black\")) #> [1]  3.3584139 -0.9872354  8.7084517  4.6428913 -4.6285576  6.0225661 colMeans(weights(rr)) #> vap_white vap_black vap_other  #> 1.0000000 1.0000000 0.9999999   mean(elec_1968$pres_ind_wal * weights(rr, \"vap_white\")) #> [1] 0.3633165"},{"path":"https://corymccartan.com/seine/reference/ei_spec.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify an ecological inference problem — ei_spec","title":"Specify an ecological inference problem — ei_spec","text":"Uses tidy-select syntax specify outcomes, predictors, covariates. result function can passed directly ei_ridge() ei_riesz(), plotted plot().","code":""},{"path":"https://corymccartan.com/seine/reference/ei_spec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify an ecological inference problem — ei_spec","text":"","code":"ei_spec(data, predictors, outcome, total, covariates = NULL, strip = TRUE)  # S3 method for class 'ei_spec' weights(object, normalize = TRUE, ...)"},{"path":"https://corymccartan.com/seine/reference/ei_spec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify an ecological inference problem — ei_spec","text":"data data frame. predictors <tidy-select> Predictor variables. x variable ecological regression primary interest. example, columns containing percentage racial group. outcome <tidy-select> Outcome variables. y variable ecological regression primary interest. example, columns containing percentage votes party. total <tidy-select> variable containing total number observations aggregate unit. example, column containing total number voters. Required default. covariates <tidy-select> Covariates. strip Whether strip common prefixes column names within group. example, columns named vap_white, vap_black, vap_hisp renamed white, black model output. object ei_spec object. normalize TRUE, normalize totals mean 1. ... Additional arguments (ignored).","code":""},{"path":"https://corymccartan.com/seine/reference/ei_spec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify an ecological inference problem — ei_spec","text":"ei_spec object, data frame additional attributes recording predictors, outcomes, total, covariates.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_spec.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify an ecological inference problem — ei_spec","text":"function lightweight perform checking arguments, bounds, sum constraints, etc.  checks performed ei_ridge() ei_riesz().","code":""},{"path":"https://corymccartan.com/seine/reference/ei_spec.html","id":"methods-by-generic-","dir":"Reference","previous_headings":"","what":"Methods (by generic)","title":"Specify an ecological inference problem — ei_spec","text":"weights(ei_spec): Extract totals specification","code":""},{"path":"https://corymccartan.com/seine/reference/ei_spec.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify an ecological inference problem — ei_spec","text":"","code":"data(elec_1968) ei_spec(elec_1968, vap_white:vap_other, pres_dem_hum:pres_oth, pres_total) #> EI Specification #> • Predictors: `white`, `black`, and `other` #> • Outcome: `dem_hum`, `rep_nix`, `ind_wal`, `abs`, and `oth` #> • Covariates: none #> # A tibble: 1,143 × 8 #>   white  black    other dem_hum rep_nix ind_wal     abs     oth #>   <dbl>  <dbl>    <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> #> 1 0.761 0.237  0.00173   0.199   0.0773   0.711 0.0122  0.0122  #> 2 0.860 0.137  0.00306   0.105   0.115    0.764 0.0161  0.0161  #> 3 0.610 0.389  0.000808  0.242   0.0489   0.687 0.0218  0.0218  #> 4 0.783 0.216  0.00106   0.141   0.0571   0.799 0.00290 0.00290 #> 5 0.981 0.0181 0.000757  0.0375  0.222    0.727 0.0134  0.0134  #> # ℹ 1,138 more rows"},{"path":"https://corymccartan.com/seine/reference/ei_synthetic.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate synthetic ecological data — ei_synthetic","title":"Generate synthetic ecological data — ei_synthetic","text":"Samples data following truncated Normal ecological model: $$      x_i \\stackrel{\\text{iid}}{\\sim} \\mathrm{Dirichlet}(\\alpha) \\\\      \\eta = z_i^\\top \\mathtt{coefs} + \\mathtt{b_{loc}} \\\\      b_i \\stackrel{\\text{iid}}{\\sim} \\mathcal{N}_{[0, 1]^d}(\\eta, \\mathtt{B_{cov}}) \\\\      y_i = b_i^\\top x_i, $$ \\(\\alpha\\) vector hyperparameters may optionally specified x argument function, \\(\\mathcal{N}_{[0, 1]^d}\\) indicates multivariate Normal distribution truncated d-dimensional hypercube. Aspects model can replaced data provided function.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_synthetic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate synthetic ecological data — ei_synthetic","text":"","code":"ei_synthetic(   n,   p = 0,   n_x = 2,   x = n_x:1,   z = NULL,   b_loc = NULL,   coefs = NULL,   b_cov = NULL )"},{"path":"https://corymccartan.com/seine/reference/ei_synthetic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate synthetic ecological data — ei_synthetic","text":"n number rows (geographies) generate. Defaults number rows x, matrix data frame. p number covariates. Defaults number columns z, matrix data frame, length z, vector singular values. n_x number predictor variables. Defaults number columns x, matrix data frame, length x, vector Dirichlet parameters. x Either matrix data frame containing predictor percentages row, vector containing Dirichlet parameters use sampling predictor percentages. z matrix data frame containing geography-level covariates, vector singular values use generating random covariates. Singular values default exp(-(seq_len(p) - 1)/2). applied scale random orthogonal matrix. b_loc center distribution geography-level parameters. Defaults linearly spaced sequence across groups 0.5 0.9. truncation, exactly mean geography-level parameters. coefs Either p--n_x matrix coefficients z, product z added ctr form mean individual geography-level parameters. Defaults matrix standard Normals. b_cov covariance matrix geography-level parameters. Defaults 0.02 * (1 + diag(n_x)).","code":""},{"path":"https://corymccartan.com/seine/reference/ei_synthetic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate synthetic ecological data — ei_synthetic","text":"ei_spec object additional attributes b_loc, coefs, b_cov, eta (linear predictor b), est_true (mean geography-level parameters, formatted similarly output ei_est()).","code":""},{"path":"https://corymccartan.com/seine/reference/ei_synthetic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate synthetic ecological data — ei_synthetic","text":"","code":"ei_synthetic(n = 10) #> EI Specification #> • Predictors: `x1` and `x2` #> • Outcome: `y` #> • Covariates: none #> # A tibble: 10 × 3 #>       y    x1     x2 #>   <dbl> <dbl>  <dbl> #> 1 0.470 0.557 0.443  #> 2 0.306 0.986 0.0139 #> 3 0.487 0.202 0.798  #> 4 0.553 0.664 0.336  #> 5 0.485 0.745 0.255  #> # ℹ 5 more rows  ei_synthetic(n = 10, p = 2, n_x = 3) #> EI Specification #> • Predictors: `x1`, `x2`, and `x3` #> • Outcome: `y` #> • Covariates: `z1` and `z2` #> # A tibble: 10 × 6 #>        y    x1     x2     x3      z1      z2 #>    <dbl> <dbl>  <dbl>  <dbl>   <dbl>   <dbl> #> 1  0.503 0.436 0.373  0.191  -0.258  -0.163  #> 2  0.494 0.487 0.350  0.164  -0.0582 -0.181  #> 3 -0.265 0.772 0.0236 0.204  -0.732  -0.123  #> 4  1.05  0.298 0.411  0.291   0.224  -0.0998 #> 5  0.437 0.712 0.242  0.0467 -0.167  -0.118  #> # ℹ 5 more rows  data(elec_1968) ei_synthetic(     x = cbind(elec_1968$pop_white, 1 - elec_1968$pop_white),     b_loc = c(0.3, 0.9),     b_cov = matrix(c(0.02, 0.016, 0.016, 0.2), nrow=2) ) #> EI Specification #> • Predictors: `x1` and `x2` #> • Outcome: `y` #> • Covariates: none #> # A tibble: 1,143 × 3 #>       y    x1     x2 #>   <dbl> <dbl>  <dbl> #> 1 0.419 0.716 0.284  #> 2 0.351 0.819 0.181  #> 3 0.501 0.538 0.462  #> 4 0.358 0.721 0.279  #> 5 0.305 0.976 0.0241 #> # ℹ 1,138 more rows"},{"path":"https://corymccartan.com/seine/reference/ei_wgt.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimation weighting models — ei_wgt","title":"Estimation weighting models — ei_wgt","text":"Several built-helper functions generate estimation weights vector unit totals, existing ei_spec() object.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_wgt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimation weighting models — ei_wgt","text":"","code":"ei_wgt_unif(x)  ei_wgt_prop(x)  ei_wgt_sqrt(x)"},{"path":"https://corymccartan.com/seine/reference/ei_wgt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimation weighting models — ei_wgt","text":"x numeric vector unit totals, existing ei_spec() object.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_wgt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimation weighting models — ei_wgt","text":"numeric vector estimation weights number observations x. mean 1.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_wgt.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Estimation weighting models — ei_wgt","text":"ei_wgt_unif(): Uniform weights. Appropriate unit-level variance constant, .e., homosekdastic. ei_wgt_prop(): Weights proportional totals. Appropriate unit-level variance inversely proportional number observations. ei_wgt_sqrt(): Weights proportional square root totals. Appropriate unit-level variance inversely proportional square root number observations.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_wgt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimation weighting models — ei_wgt","text":"","code":"data(elec_1968)  ei_wgt_unif(head(elec_1968$pres_total)) #> [1] 1 1 1 1 1 1  spec = ei_spec(head(elec_1968), predictors = vap_white:vap_other,                outcome = pres_ind_wal, total = pres_total) ei_wgt_prop(spec) #> [1] 0.8851989 2.1516032 0.9151221 0.5219934 1.0283945 0.4976879 ei_wgt_sqrt(spec) #> [1] 0.9722265 1.5157519 0.9885225 0.7465854 1.0479170 0.7289967"},{"path":"https://corymccartan.com/seine/reference/ei_wrap_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrap another predictive model for use in ei_est — ei_wrap_model","title":"Wrap another predictive model for use in ei_est — ei_wrap_model","text":"Stores additional data attributes generic model class can used regr argument ei_est(). Given wide variety model classes, guarantee function work. However, model classes supporting fitted() predict() method work long transformation predictor variables part model formula fitting.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_wrap_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrap another predictive model for use in ei_est — ei_wrap_model","text":"","code":"ei_wrap_model(x, data, predictors = NULL, outcome = NULL)"},{"path":"https://corymccartan.com/seine/reference/ei_wrap_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrap another predictive model for use in ei_est — ei_wrap_model","text":"x model object, supporting fitted() predict() generics. data data frame matrix containing data used fit model, ei_spec() object (recommended). latter, predictors outcome arguments ignored need provided. predictors <tidy-select> Predictor variables. x variable ecological regression primary interest. example, columns containing percentage racial group. outcome <tidy-select> Outcome variables. y variable ecological regression primary interest. example, columns containing percentage votes party.","code":""},{"path":"https://corymccartan.com/seine/reference/ei_wrap_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrap another predictive model for use in ei_est — ei_wrap_model","text":"ei_wrapped object, information required use provided x ei_est().","code":""},{"path":"https://corymccartan.com/seine/reference/ei_wrap_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wrap another predictive model for use in ei_est — ei_wrap_model","text":"","code":"data(elec_1968)  spec = ei_spec(elec_1968, vap_white:vap_other, pres_ind_wal, pres_total,                covariates = c(pop_urban, farm))  m = lm(pres_ind_wal ~ 0 + white + black + other + pop_urban + farm, spec) m_wrap = ei_wrap_model(m, spec) print(m_wrap) #> A wrapped <lm> model with 1143 observations  ei_est(m_wrap, data = spec) #> # A tibble: 3 × 4 #>   predictor outcome      estimate std.error #>   <chr>     <chr>           <dbl>     <dbl> #> 1 white     pres_ind_wal    0.334    0.0236 #> 2 black     pres_ind_wal    0.750    0.0573 #> 3 other     pres_ind_wal   -1.63     0.206"},{"path":"https://corymccartan.com/seine/reference/elec_1968.html","id":null,"dir":"Reference","previous_headings":"","what":"1968 U.S. presidential election data — elec_1968","title":"1968 U.S. presidential election data — elec_1968","text":"County-level dataset containing election results demographics 1968 U.S. presidential election states Virginia, North Carolina, South Carolina, Georgia, Florida, Alabama, Mississippi, Louisiana, Arkansas, Tennessee, Texas.","code":""},{"path":"https://corymccartan.com/seine/reference/elec_1968.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"1968 U.S. presidential election data — elec_1968","text":"","code":"elec_1968"},{"path":"https://corymccartan.com/seine/reference/elec_1968.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"1968 U.S. presidential election data — elec_1968","text":"data frame 1,143 rows 41 variables: fips County FIPS code state State name abbr State abbreviation region Census region division Census division county County name pop Total population 1970 census pop_city, pop_urban, pop_rural Proportion population city, urban rural areas pop_white, pop_black, pop_aian, pop_asian, pop_hisp Proportion population racial group. first four columns sum 1, pop_hisp considered separately. vap Voting-age population 1970 census vap_white, vap_black, vap_other Proportion voting-age population racial group farm, nonfarm Proportion population farm non-farm households educ_elem, educ_hsch, educ_coll Proportion population elementary, high school, college education cvap Citizen voting-age population 1970 census cvap_white, cvap_black, cvap_other Proportion citizen voting-age population racial group inc_00_03k, inc_03_08k, inc_08_25k, inc_25_99k Proportion population households income bracket. Median household income 1970 $9,870 pres_dem_hum, pres_rep_nix, pres_ind_wal, pres_abs, pres_oth Proportion votes Humphrey, Nixon, Wallace, candidates. pres_abs calculated one minus Humphrey, Nixon, Wallace vote shares. pres_total Total number votes cast president. pres_turn Proportion voting-age population turned vote. pres_turn_icpsr Proportion voting-age population turned vote using ICPSR data denominator. adj FIPS-indexed adjacency list capturing geographic (rook) adjacency counties. convert 1-indexed adjacency list, run lapply(elec_1968$adj, function(x) match(x, elec_1968$fips)).","code":""},{"path":"https://corymccartan.com/seine/reference/elec_1968.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"1968 U.S. presidential election data — elec_1968","text":"Census data: Steven Manson, Jonathan Schroeder, David Van Riper, Katherine Knowles, Tracy Kugler, Finn Roberts, Steven Ruggles. IPUMS National Historical Geographic Information System: Version 19.0. 1970 Decennial Census. Minneapolis, MN: IPUMS. 2024. doi:10.18128/D050.V19.0 Presidential election data: Clubb, Jerome M., Flanigan, William H., Zingale, Nancy H. Electoral Data Counties United States: Presidential Congressional Races, 1840-1972. Inter-university Consortium Political Social Research (distributor), 2006-11-13. doi:10.3886/ICPSR08611.v1","code":""},{"path":"https://corymccartan.com/seine/reference/plot.ei_spec.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot an EI specification — plot.ei_spec","title":"Plot an EI specification — plot.ei_spec","text":"Useful quickly visualizing scatterplots outcome versus predictor variables.","code":""},{"path":"https://corymccartan.com/seine/reference/plot.ei_spec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot an EI specification — plot.ei_spec","text":"","code":"# S3 method for class 'ei_spec' plot(x, ..., pch = 16, cex = 0.2)"},{"path":"https://corymccartan.com/seine/reference/plot.ei_spec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot an EI specification — plot.ei_spec","text":"x ei_spec object. ... Additional arguments passed pairs(). pch, cex plot()","code":""},{"path":"https://corymccartan.com/seine/reference/plot.ei_spec.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot an EI specification — plot.ei_spec","text":"","code":"data(elec_1968) spec = ei_spec(elec_1968, vap_white:vap_other, pres_dem_hum:pres_oth, pres_total) plot(spec)"},{"path":"https://corymccartan.com/seine/reference/ridge-methods.html","id":null,"dir":"Reference","previous_headings":"","what":"Methods for ei_ridge models — ridge-methods","title":"Methods for ei_ridge models — ridge-methods","text":"Models fitted ei_ridge() support various generic methods.","code":""},{"path":"https://corymccartan.com/seine/reference/ridge-methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for ei_ridge models — ridge-methods","text":"","code":"# S3 method for class 'ei_ridge' predict(object, new_data, type = \"numeric\", ...)  # S3 method for class 'ei_ridge' fitted(object, ...)  # S3 method for class 'ei_ridge' residuals(object, ...)  # S3 method for class 'ei_ridge' summary(object, ...)  # S3 method for class 'ei_ridge' weights(object, normalize = TRUE, ...)"},{"path":"https://corymccartan.com/seine/reference/ridge-methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for ei_ridge models — ridge-methods","text":"object fitted ei_ridge model new_data data frame, matrix, ei_spec new predictors. type type predictions generate; \"numeric\" supported. ... Additional arguments (ignored) normalize TRUE, normalize weights mean 1.","code":""},{"path":"https://corymccartan.com/seine/reference/ridge-methods.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Methods for ei_ridge models — ridge-methods","text":"predict(ei_ridge): Predict ei_ridge model. fitted(ei_ridge): Extract fitted values. residuals(ei_ridge): Extract residuals. summary(ei_ridge): Summarize model's fitted values \\(R^2\\). weights(ei_ridge): Extract estimation weights fitted model.","code":""},{"path":"https://corymccartan.com/seine/reference/seine-package.html","id":null,"dir":"Reference","previous_headings":"","what":"seine: Semiparametric Ecological Inference — seine-package","title":"seine: Semiparametric Ecological Inference — seine-package","text":"Efficient user-friendly routines modern ecological inference. Implements methods described McCartan & Kuriwaki (2025) arXiv:2507.XXXXX, generalize ecological regression introduced Goodman (1953) doi:10.2307/2088121 . Includes routines preprocessing, synthetic data generation, double/debiased machine learning (DML) estimation, sensitivity analysis.","code":""},{"path":[]},{"path":"https://corymccartan.com/seine/reference/seine-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"seine: Semiparametric Ecological Inference — seine-package","text":"Maintainer: Cory McCartan mccartan@psu.edu (ORCID) Authors: Shiro Kuriwaki shiro.kuriwaki@yale.edu (ORCID)","code":""},{"path":"https://corymccartan.com/seine/reference/weights.ei_riesz.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Riesz representer weights — weights.ei_riesz","title":"Extract Riesz representer weights — weights.ei_riesz","text":"Extracts single set Riesz representer weights ei_riesz object, selected group.","code":""},{"path":"https://corymccartan.com/seine/reference/weights.ei_riesz.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Riesz representer weights — weights.ei_riesz","text":"","code":"# S3 method for class 'ei_riesz' weights(object, group = TRUE, loo = FALSE, ...)"},{"path":"https://corymccartan.com/seine/reference/weights.ei_riesz.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Riesz representer weights — weights.ei_riesz","text":"object ei_riesz() object. group group extract weights, numeric index character column name. special (default) value TRUE return matrix weights, column corresponding group. loo TRUE, return leave-one-weights ... Additional arguments (ignored)","code":""},{"path":"https://corymccartan.com/seine/reference/weights.ei_riesz.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Riesz representer weights — weights.ei_riesz","text":"numeric vector weights","code":""},{"path":"https://corymccartan.com/seine/news/index.html","id":"seine-010","dir":"Changelog","previous_headings":"","what":"seine 0.1.0","title":"seine 0.1.0","text":"Double/debiased ML ecological inference Preprocessing helper functions Synthetic EI data","code":""}]
